# OS Introduction

- What is an **operating system**?
  - The software placed between the hardware and applications/utilities on a computer
  - Improves efficiency and usability
- The operating system customizes a system for a given use case
- What does an operating system do?
  - Allocates resources
  - Manages execution of user programs
- Types of programs
  - The **kernel** runs at all times and is part of the operating system
  - **System progams** come with the operating system but are not part of the kernel
  - **Application programs** are any programs that are not associated with the operating system
- Major OS functions
  - Control access and provide interfaces to the OS and devices attached to the system
  - Manage resources: control resource usage among different tasks and implement policies
  - Provide abstractions by hiding the specific details of the hardware, i.e. device-independent I/O
-  A **device controller** is in charge of a particular device type
  - Each one has a device **driver** to manage it
- A device controller informs the CPU that it has finished an operation by causing an **interrupt**
- An interrupt transfer control the to the interrupt service routine
  - Generally done through the **interrupt vector**, which contains the addresses of every service routine
  - Interrupt architecture must save the address of the interrupted instruction
- An interrupt is generated by hardware, but a **trap** (exception) is generated by software 
- Interrupt handling
  - The OS preserves the state of the CPU by storing registers and the program counter
  - The OS determines which type of interrupt has occurred
  - Separate segments of code determine which action should be taken for each type of interrupt
- An interrupt can be sent when input is ready, output is complete, or when an error has occurred
- Asynchronous I/O
  - Once I/O starts, control returns to the user program without waiting for the I/O to complete
  - System call: request to the OS to allow user to wait for I/O completion
  - The **device-status table** contains an entry for each I/O device that indicates its type, address and state
  - The OS indexes into the I/O device table to determine device status and to modify the table entry to include the interrupt
- Main memory can be accessed directly by the CPU
  - Random access and typically volatile
- For storage devices, storage capacity and access time are inversely related
- Order of OS operations
  - The **bootstrap program** is the first program to runâ€”initialzes the system and loads the kernel
  - The kernel loads
  - The kernel starts system **daemons**, which are services provided outside of the kernel
  - The kernel is interrupt-driven
- Multiprogramming (Batch System)
  - The goal is to keep the CPU busy and always give it a program to run
  - When the CPU has to wait on a process it switches to another one
  - Jobs are organized via job scheduling
- Timesharing (Multitasking)
  - The CPU switches jobs very frequently so that users can interact with each job while it is running (interactive)
  - The response time should be less than 1 second
  - If processes don't fit in memory, swapping moves them in and out to run
  - Virtual memory allows execution of processes not completely in memory
- Dual-mode operation
  - Operating systems have two modes: **user mode** and **kernel mode**
  - This allows the OS to protect itself and other system components
  - A **mode bit** is provided by the hardware, which can distinguish whether the system is running in user code or kernel code
  - Some instrructions are **privileged** and can only be executed in kernel mode
  - A system call changes the mode to kernel, and the return from the call sets the mode back to user
  - System calls are executed in kernel mode
- How is a system call processed?
  1. System service is requested via system call
  2. Switch mode + verify arguments and service
  3. Branch to the service function via system call table
  4. Return from the service function and switch mode back
  5. Return from system call
- Processes
  - A process is a program that is being executed
  - A process needs resources to accomplish its task(s), i.e. CPU, memory, I/O, files
  - When a process terminates, its resources are reclaimed and can be used by other processes
  - Single-threaded processes have a program counter which specifies the location of the next instruction to execute
    - Multi-threaded processes have one program counter per thread
- Process management done by the OS
  - Creating and deleting both user and system processes
  - Suspending and resuming processes
  - Providing mechanisms for process synchronization
  - Providing mechanisms for process communication
  - Providing mechanisms for deadlock handling
- Memory management
  - To execute a program, all or part of the instructions **and** data must be in memory
  - Memory management determines what is in memory and when
  - Memory management activities include:
    - Keeping track of which parts of memory are currently in use and by whom
    - Deciding which processes (or parts of processes) and data to move in and out of memory
    - Allocating and deallocating memory space as needed